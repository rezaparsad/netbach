{% extends "panel/base.html" %}

{% block title %}مشخصات سرور{% endblock %}

{% block head %}
    <style>
        svg {
            fill: var(--primary-color-background);
        }
    </style>
{% endblock %}

{% block content %}
    <div id="toast-notification" class="toast toast-location position-absolute top-0 mt-3 ms-3 ms-sm-0" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header d-flex justify-content-end">
            <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
        <div class="toast-body">
            <span id="toast-message" class="text-white"></span>
        </div>
    </div>
    <div class="container rounded-4 border bg-white p-4">
        <div class="d-flex justify-content-center bg-alert rounded p-3">
            <span>مشخصات سرور <span class="fw-bolder text-primary">{{ server.name }}</span></span>
        </div>
        <div class="row mt-5 mb-2">
            <div class="col-12 justify-content-center d-flex align-items-center" style="font-weight: bold; ">
                <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Pro 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M256 480c16.7 0 40.4-14.4 61.9-57.3c9.9-19.8 18.2-43.7 24.1-70.7H170c5.9 27 14.2 50.9 24.1 70.7C215.6 465.6 239.3 480 256 480zM164.3 320H347.7c2.8-20.2 4.3-41.7 4.3-64s-1.5-43.8-4.3-64H164.3c-2.8 20.2-4.3 41.7-4.3 64s1.5 43.8 4.3 64zM170 160H342c-5.9-27-14.2-50.9-24.1-70.7C296.4 46.4 272.7 32 256 32s-40.4 14.4-61.9 57.3C184.2 109.1 175.9 133 170 160zm210 32c2.6 20.5 4 41.9 4 64s-1.4 43.5-4 64h90.8c6-20.3 9.3-41.8 9.3-64s-3.2-43.7-9.3-64H380zm78.5-32c-25.9-54.5-73.1-96.9-130.9-116.3c21 28.3 37.6 68.8 47.2 116.3h83.8zm-321.1 0c9.6-47.6 26.2-88 47.2-116.3C126.7 63.1 79.4 105.5 53.6 160h83.7zm-96 32c-6 20.3-9.3 41.8-9.3 64s3.2 43.7 9.3 64H132c-2.6-20.5-4-41.9-4-64s1.4-43.5 4-64H41.3zM327.5 468.3c57.8-19.5 105-61.8 130.9-116.3H374.7c-9.6 47.6-26.2 88-47.2 116.3zm-143 0c-21-28.3-37.5-68.8-47.2-116.3H53.6c25.9 54.5 73.1 96.9 130.9 116.3zM256 512A256 256 0 1 1 256 0a256 256 0 1 1 0 512z"/></svg>
                <span class="ms-2">آیپی v4 : </span>
                <span id="ipv4" class="ms-2 fw-bold" style="cursor: pointer; font-size: 1rem;">{{ server.ipv4 }}</span>
            </div>
            <div class="col-12 justify-content-center mt-3 d-flex align-items-center" style="font-weight: bold; ">
                <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Pro 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M256 480c16.7 0 40.4-14.4 61.9-57.3c9.9-19.8 18.2-43.7 24.1-70.7H170c5.9 27 14.2 50.9 24.1 70.7C215.6 465.6 239.3 480 256 480zM164.3 320H347.7c2.8-20.2 4.3-41.7 4.3-64s-1.5-43.8-4.3-64H164.3c-2.8 20.2-4.3 41.7-4.3 64s1.5 43.8 4.3 64zM170 160H342c-5.9-27-14.2-50.9-24.1-70.7C296.4 46.4 272.7 32 256 32s-40.4 14.4-61.9 57.3C184.2 109.1 175.9 133 170 160zm210 32c2.6 20.5 4 41.9 4 64s-1.4 43.5-4 64h90.8c6-20.3 9.3-41.8 9.3-64s-3.2-43.7-9.3-64H380zm78.5-32c-25.9-54.5-73.1-96.9-130.9-116.3c21 28.3 37.6 68.8 47.2 116.3h83.8zm-321.1 0c9.6-47.6 26.2-88 47.2-116.3C126.7 63.1 79.4 105.5 53.6 160h83.7zm-96 32c-6 20.3-9.3 41.8-9.3 64s3.2 43.7 9.3 64H132c-2.6-20.5-4-41.9-4-64s1.4-43.5 4-64H41.3zM327.5 468.3c57.8-19.5 105-61.8 130.9-116.3H374.7c-9.6 47.6-26.2 88-47.2 116.3zm-143 0c-21-28.3-37.5-68.8-47.2-116.3H53.6c25.9 54.5 73.1 96.9 130.9 116.3zM256 512A256 256 0 1 1 256 0a256 256 0 1 1 0 512z"/></svg>
                <span class="ms-2">آیپی v6 : </span>
                <span class="ms-2 fw-bold" style="font-size: 1rem;">{{ server.ipv6 }}</span>
            </div>
            <hr class="mt-4">
            <div class="col-12 col-sm-4 col-lg-3 mt-3 justify-content-center d-flex align-items-center">
                <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Pro 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M176 16c0-8.8-7.2-16-16-16s-16 7.2-16 16V64H128c-35.3 0-64 28.7-64 64v16H16c-8.8 0-16 7.2-16 16s7.2 16 16 16H64v64H16c-8.8 0-16 7.2-16 16s7.2 16 16 16H64v64H16c-8.8 0-16 7.2-16 16s7.2 16 16 16H64v16c0 35.3 28.7 64 64 64h16v48c0 8.8 7.2 16 16 16s16-7.2 16-16V448h64v48c0 8.8 7.2 16 16 16s16-7.2 16-16V448h64v48c0 8.8 7.2 16 16 16s16-7.2 16-16V448h16c35.3 0 64-28.7 64-64V368h48c8.8 0 16-7.2 16-16s-7.2-16-16-16H448V272h48c8.8 0 16-7.2 16-16s-7.2-16-16-16H448V176h48c8.8 0 16-7.2 16-16s-7.2-16-16-16H448V128c0-35.3-28.7-64-64-64H368V16c0-8.8-7.2-16-16-16s-16 7.2-16 16V64H272V16c0-8.8-7.2-16-16-16s-16 7.2-16 16V64H176V16zM416 128V384c0 17.7-14.3 32-32 32H128c-17.7 0-32-14.3-32-32V128c0-17.7 14.3-32 32-32H384c17.7 0 32 14.3 32 32zm-256 0c-17.7 0-32 14.3-32 32V352c0 17.7 14.3 32 32 32H352c17.7 0 32-14.3 32-32V160c0-17.7-14.3-32-32-32H160zm192 32V352H160V160H352z"/></svg>
                <span class="ms-2">RAM : </span>
                <span class="ms-2 fw-bold">{{ server.server.ram }}</span>
            </div>
            <div class="col-12 col-sm-4 col-lg-3 mt-3 justify-content-center d-flex align-items-center">
                <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Pro 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M64 64C46.3 64 32 78.3 32 96V264.6c9.4-5.4 20.3-8.6 32-8.6H448c11.7 0 22.6 3.1 32 8.6V96c0-17.7-14.3-32-32-32H64zM32 320v96c0 17.7 14.3 32 32 32H448c17.7 0 32-14.3 32-32V320c0-17.7-14.3-32-32-32H64c-17.7 0-32 14.3-32 32zM0 320V96C0 60.7 28.7 32 64 32H448c35.3 0 64 28.7 64 64V320v96c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V320zm320 24a24 24 0 1 1 0 48 24 24 0 1 1 0-48zm72 24a24 24 0 1 1 48 0 24 24 0 1 1 -48 0z"/></svg>
                <span class="ms-2">CPU : </span>
                <span class="ms-2 fw-bold">{{ server.server.cpu }}</span>
            </div>
            <div class="col-12 col-sm-4 col-lg-3 mt-3 justify-content-center d-flex align-items-center">
                <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Pro 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M64 128c-17.7 0-32 14.3-32 32V352c0 17.7 14.3 32 32 32H416V128H64zM0 160c0-35.3 28.7-64 64-64H416c17.7 0 32 14.3 32 32V384c0 17.7-14.3 32-32 32H64c-35.3 0-64-28.7-64-64V160zM480 384V352H608V160H480V128H608c17.7 0 32 14.3 32 32V352c0 17.7-14.3 32-32 32H480zm96-176a16 16 0 1 1 -32 0 16 16 0 1 1 32 0zM560 320a16 16 0 1 1 0-32 16 16 0 1 1 0 32z"/></svg>
                <span class="ms-2">DISK : </span>
                <span class="ms-2 fw-bold">{{ server.server.disk }}</span>
            </div>
            <div class="col-12 col-sm-4 col-lg-3 mt-3 justify-content-center d-flex align-items-center">
                <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Pro 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M272 16c0-8.8-7.2-16-16-16s-16 7.2-16 16V329.4L139.3 228.7c-6.2-6.2-16.4-6.2-22.6 0s-6.2 16.4 0 22.6l128 128c6.2 6.2 16.4 6.2 22.6 0l128-128c6.2-6.2 6.2-16.4 0-22.6s-16.4-6.2-22.6 0L272 329.4V16zM140.1 320H64c-35.3 0-64 28.7-64 64v64c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V384c0-35.3-28.7-64-64-64H371.9l-32 32H448c17.7 0 32 14.3 32 32v64c0 17.7-14.3 32-32 32H64c-17.7 0-32-14.3-32-32V384c0-17.7 14.3-32 32-32H172.1l-32-32zM432 416a24 24 0 1 0 -48 0 24 24 0 1 0 48 0z"/></svg>
                <span class="ms-2">Traffic : </span>
                <span class="ms-2 fw-bold">{{ server.server.traffic }}</span>
            </div>
        </div>
    </div>
    <div class="container rounded-4 border bg-white p-4 my-3">
        <div class="d-flex justify-content-center bg-alert rounded p-3">
            <span>اطلاعات مربوط به هزینه سرور</span>
        </div>
        <div class="row justify-content-around mt-4">
            <div class="col-12 col-sm-6 text-center">
                <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Pro 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M176 16c0-8.8-7.2-16-16-16s-16 7.2-16 16V63.5c-6.3 .1-12.6 .3-18.8 .9c-24 2-47.9 7.8-67.4 20.6C37.7 98.1 23.2 118 17.9 146c-3.8 20.3-1.9 38.2 5.7 53.7C31 215 43.1 226.5 57.1 235.4c26.7 17 63.6 26.7 97.2 35.5l1.7 .4c35.7 9.4 67.8 17.9 89.8 31.9c10.6 6.8 17.8 14.2 21.9 22.6c4 8.3 5.8 19 3 33.8c-3.9 20.7-18.4 36.4-42.9 46c-24.9 9.8-59.1 12.6-98 7c-24.4-3.6-61-12.1-91.3-25.2c-8.1-3.5-17.5 .2-21 8.4s.2 17.5 8.4 21c33.6 14.5 73.1 23.5 99.3 27.4l.1 0c6.4 .9 12.7 1.6 18.9 2.1V496c0 8.8 7.2 16 16 16s16-7.2 16-16V447.4c23.2-.7 44.8-4.7 63.4-11.9c32-12.5 56.2-35.7 62.7-69.9c3.8-20.3 1.9-38.2-5.7-53.7c-7.4-15.3-19.6-26.8-33.5-35.6c-26.7-17-63.6-26.7-97.2-35.5l-1.7-.4c-35.7-9.4-67.8-17.9-89.8-31.9c-10.6-6.8-17.8-14.2-21.9-22.6c-4-8.3-5.8-19-3-33.8c3.6-19.3 13.1-31.8 26-40.2c13.4-8.8 31.5-13.7 52.6-15.5c42.3-3.5 91.3 6 124.3 14c8.6 2.1 17.2-3.2 19.3-11.8s-3.2-17.2-11.8-19.3c-21.9-5.3-52.1-11.7-83.8-14.4V16z"/></svg>
                <span class="ms-2">هزینه کل سرور در ماه : </span>
                <span class="ms-2 fw-bold">{{ server.server.price }}</span>
            </div>
            <div class="col-12 col-sm-6 text-center mt-4 mt-sm-0">
                <svg width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Pro 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M176 16c0-8.8-7.2-16-16-16s-16 7.2-16 16V63.5c-6.3 .1-12.6 .3-18.8 .9c-24 2-47.9 7.8-67.4 20.6C37.7 98.1 23.2 118 17.9 146c-3.8 20.3-1.9 38.2 5.7 53.7C31 215 43.1 226.5 57.1 235.4c26.7 17 63.6 26.7 97.2 35.5l1.7 .4c35.7 9.4 67.8 17.9 89.8 31.9c10.6 6.8 17.8 14.2 21.9 22.6c4 8.3 5.8 19 3 33.8c-3.9 20.7-18.4 36.4-42.9 46c-24.9 9.8-59.1 12.6-98 7c-24.4-3.6-61-12.1-91.3-25.2c-8.1-3.5-17.5 .2-21 8.4s.2 17.5 8.4 21c33.6 14.5 73.1 23.5 99.3 27.4l.1 0c6.4 .9 12.7 1.6 18.9 2.1V496c0 8.8 7.2 16 16 16s16-7.2 16-16V447.4c23.2-.7 44.8-4.7 63.4-11.9c32-12.5 56.2-35.7 62.7-69.9c3.8-20.3 1.9-38.2-5.7-53.7c-7.4-15.3-19.6-26.8-33.5-35.6c-26.7-17-63.6-26.7-97.2-35.5l-1.7-.4c-35.7-9.4-67.8-17.9-89.8-31.9c-10.6-6.8-17.8-14.2-21.9-22.6c-4-8.3-5.8-19-3-33.8c3.6-19.3 13.1-31.8 26-40.2c13.4-8.8 31.5-13.7 52.6-15.5c42.3-3.5 91.3 6 124.3 14c8.6 2.1 17.2-3.2 19.3-11.8s-3.2-17.2-11.8-19.3c-21.9-5.3-52.1-11.7-83.8-14.4V16z"/></svg>
                <span class="ms-2">هزینه مصرف شده تا به امروز : </span>
                <span class="ms-2 fw-bold">{{ server.cost }}</span>
            </div>
        </div>
    </div>
    <div class="container rounded-4 border bg-white p-4 my-3">
        <div class="d-flex justify-content-center bg-alert rounded p-3">
            <span>از منوی زیر می توانید عملیات مربوط به سرور را انجام دهید</span>
        </div>
        <div class="d-flex justify-content-center rounded p-3 mt-3" style="background-color: #d9d605">
            <span>هزینه تعویض آیپی سرور ، 1000 تومان می باشد</span>
        </div>
        <div id="wrapper-root-password" class="d-none justify-content-center bg-success rounded mt-3 p-3">
            <span class="text-white">رمز جدید سرور : </span>
            <span id="root-password" class="text-white ms-2"></span>
        </div>
        <div class="d-flex flex-column flex-sm-row flex-sm-wrap justify-content-between mt-5">
            <button onclick="serverAction('reboot')" class="btn bg-primary text-white mt-3 mt-sm-0">ریبوت سرور</button>
            <button onclick="serverAction('power-on')" class="btn bg-primary text-white mt-3 mt-sm-0">روشن کردن سرور</button>
            <button onclick="serverAction('power-off')" class="btn bg-primary text-white mt-3 mt-sm-0">خاموش کردن سرور</button>
            <button onclick="serverAction('change-password')" class="btn bg-primary text-white mt-3 mt-sm-0">تغییر رمز سرور</button>
            <button onclick="serverAction('change-ip')" class="btn bg-primary text-white mt-3 mt-sm-0">تعویض آیپی v4</button>
            <button onclick="showToast('success', 'آیپی سرور و سیستم عامل جدید را در تیکت برای پشتیبانی ارسال کنید تا مراحل انجام شود')" class="btn bg-primary text-white mt-3 mt-sm-0">نصب مجدد سرور</button>
            <button onclick="showToast('success', 'آیپی سرور و مشخصات جدید را در تیکت برای پشتیبانی ارسال کنید تا مراحل انجام شود')" class="btn bg-primary text-white mt-3 mt-sm-0">ارتقاء سرور</button>
            <button onclick="serverAction('delete')" class="btn bg-danger text-white mt-3 mt-sm-0">حذف سرور</button>
        </div>
    </div>
    <div class="container rounded-4 border bg-white p-4 my-3">
        <div class="d-flex justify-content-center bg-alert rounded p-3">
            <span>فعالیت های انجام شده بر روی سرور</span>
        </div>
        <div class="d-flex flex-column mt-4">
            {% if activities %}
                {% for activity in activities %}
                    <div class="d-flex justify-content-between border p-3 rounded mt-2">
                        <span>{{ activity.activity }}</span>
                        <span>{{ activity.created }}</span>
                    </div>
                {% endfor %}
                <div class="d-flex justify-content-center mt-4">
                    <a href="{% url 'server-activity' server.slug %}">
                        <button class="btn bg-primary text-white">نمایش همه فعالیت ها</button>
                    </a>
                </div>
            {% else %}
                <div class="bg-alert p-3 rounded-4 mt-5">
                    <span>موردی برای نمایش یافت نشد.</span>
                </div>
            {% endif %}
        </div>
    </div>
    <div class="modal fade" id="server-modal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-body">
                    <span id="content-modal"></span>
                </div>
                <div class="modal-footer d-flex justify-content-center">
                    <button id="button-confirm" type="button" class="btn bg-success text-white px-4 mx-3">تایید</button>
                    <button type="button" class="btn bg-danger text-white px-4 mx-3" data-bs-dismiss="modal">لغو</button>
                </div>
            </div>
        </div>
    </div>
    <div id="loadingView" class="d-none justify-content-center align-items-center position-fixed top-0 start-0 text-center w-100 h-100" style="z-index: 5; outline: 0; top: 0; background-color: #00000080">
        <div class="shadow rounded-2 bg-white px-5 pb-2" style="width: fit-content">
            <svg width="160" height="80" viewBox="0 0 587 70" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M8.72852 6.125V68H0.291016V0.5H14.3535L53.6846 59.5625L93.0156 0.5H106.463V68H98.0254V7.04785L57.9473 68H49.4219L8.72852 6.125ZM170.931 61.0566C170.843 61.4082 170.184 62.2871 168.953 63.6934C168.074 64.748 166.902 65.6855 165.438 66.5059C163.973 67.2969 162.01 67.9121 159.549 68.3516C157.117 68.8203 153.909 69.0547 149.925 69.0547C144.622 69.0547 140.096 68.7764 136.346 68.2197C132.596 67.6924 129.534 66.8721 127.161 65.7588C124.788 64.6162 123.045 63.166 121.932 61.4082C120.848 59.6504 120.306 57.5557 120.306 55.124C120.306 52.5752 120.599 50.4219 121.185 48.6641C121.8 46.877 122.679 45.3828 123.821 44.1816C124.993 42.9805 126.399 42.043 128.04 41.3691C129.681 40.6953 131.541 40.1826 133.621 39.8311C135.73 39.4795 138.03 39.2598 140.521 39.1719C143.011 39.084 145.662 39.04 148.475 39.04C152.488 39.04 155.843 39.2158 158.538 39.5674C161.233 39.8896 163.431 40.3145 165.13 40.8418C166.858 41.3398 168.162 41.8818 169.041 42.4678C169.92 43.0537 170.55 43.5957 170.931 44.0938C170.931 40.8125 170.784 38.0146 170.491 35.7002C170.228 33.3857 169.773 31.4521 169.129 29.8994C168.514 28.3467 167.708 27.1162 166.712 26.208C165.716 25.2705 164.485 24.5674 163.021 24.0986C161.585 23.6299 159.9 23.3369 157.967 23.2197C156.033 23.0732 153.821 23 151.331 23C147.464 23 144.256 23.1025 141.707 23.3076C139.158 23.4834 137.137 23.8496 135.643 24.4062C134.148 24.9629 133.094 25.7393 132.479 26.7354C131.863 27.7021 131.556 28.9766 131.556 30.5586H123.118C123.118 27.8926 123.587 25.6367 124.524 23.791C125.491 21.9453 127.073 20.4512 129.271 19.3086C131.497 18.1367 134.412 17.2871 138.016 16.7598C141.619 16.2324 146.058 15.9688 151.331 15.9688C156.487 15.9688 160.853 16.3936 164.427 17.2432C168.001 18.0928 170.887 19.5869 173.084 21.7256C175.311 23.8643 176.907 26.75 177.874 30.3828C178.87 33.9863 179.368 38.5566 179.368 44.0938V68H170.931V61.0566ZM151.331 62.375C155.052 62.375 158.157 62.1992 160.647 61.8477C163.167 61.4961 165.188 60.9688 166.712 60.2656C168.235 59.5625 169.319 58.6836 169.964 57.6289C170.608 56.5742 170.931 55.3438 170.931 53.9375C170.931 52.5312 170.55 51.3447 169.788 50.3779C169.056 49.3818 167.811 48.5762 166.053 47.9609C164.324 47.3457 162.024 46.9062 159.153 46.6426C156.282 46.3496 152.737 46.2031 148.519 46.2031C144.3 46.2031 140.887 46.2764 138.279 46.4229C135.701 46.5693 133.709 46.9062 132.303 47.4336C130.896 47.9609 129.944 48.7373 129.446 49.7627C128.978 50.7881 128.743 52.1797 128.743 53.9375C128.743 55.6953 128.992 57.1309 129.49 58.2441C130.018 59.3281 131.072 60.1777 132.654 60.793C134.236 61.4082 136.507 61.833 139.466 62.0674C142.454 62.2725 146.409 62.375 151.331 62.375ZM241.111 68L220.809 46.8184L200.506 68H189.256L215.184 42.248L190.486 17.375H201.736L221.028 36.9307L239.881 17.375H251.131L226.434 42.2041L252.361 68H241.111Z" fill="#9D28FF"></path>
                <path d="M273.455 68H265.018V0.5H279.827L341.702 59.5625V0.5H350.14V68H338.89L273.455 7.53125V68ZM362.84 42.3359C362.84 37.1504 363.396 32.8584 364.51 29.46C365.623 26.0615 367.41 23.3662 369.871 21.374C372.332 19.3818 375.525 17.9902 379.451 17.1992C383.377 16.3789 388.152 15.9688 393.777 15.9688C399.402 15.9688 404.178 16.3789 408.104 17.1992C412.029 17.9902 415.223 19.3818 417.684 21.374C420.145 23.3662 421.932 26.0615 423.045 29.46C424.158 32.8584 424.715 37.1504 424.715 42.3359C424.715 47.5215 424.158 51.8281 423.045 55.2559C421.932 58.6836 420.145 61.4082 417.684 63.4297C415.223 65.4512 412.029 66.8867 408.104 67.7363C404.178 68.5566 399.402 68.9668 393.777 68.9668C388.152 68.9668 383.377 68.5566 379.451 67.7363C375.525 66.8867 372.332 65.4512 369.871 63.4297C367.41 61.4082 365.623 58.6836 364.51 55.2559C363.396 51.8281 362.84 47.5215 362.84 42.3359ZM371.277 42.3359C371.277 45.1484 371.38 47.5947 371.585 49.6748C371.79 51.7549 372.171 53.542 372.728 55.0361C373.313 56.5303 374.119 57.7461 375.145 58.6836C376.17 59.6211 377.518 60.3682 379.188 60.9248C380.857 61.4814 382.879 61.8623 385.252 62.0674C387.654 62.2725 390.496 62.375 393.777 62.375C396.59 62.375 399.095 62.3164 401.292 62.1992C403.519 62.0527 405.452 61.7451 407.093 61.2764C408.763 60.8076 410.184 60.1484 411.355 59.2988C412.527 58.4199 413.465 57.2334 414.168 55.7393C414.9 54.2451 415.428 52.4141 415.75 50.2461C416.102 48.0488 416.277 45.4121 416.277 42.3359C416.277 39.3184 416.102 36.7549 415.75 34.6455C415.428 32.5068 414.9 30.7197 414.168 29.2842C413.465 27.8486 412.527 26.7207 411.355 25.9004C410.184 25.0508 408.763 24.4209 407.093 24.0107C405.452 23.5713 403.519 23.293 401.292 23.1758C399.095 23.0586 396.59 23 393.777 23C390.965 23 388.445 23.0586 386.219 23.1758C384.021 23.293 382.088 23.5713 380.418 24.0107C378.777 24.4209 377.371 25.0508 376.199 25.9004C375.027 26.7207 374.075 27.8486 373.343 29.2842C372.64 30.7197 372.112 32.5068 371.761 34.6455C371.438 36.7549 371.277 39.3184 371.277 42.3359ZM455.652 68L428.934 17.375H438.777L461.277 62.375L483.777 17.375H493.621L466.902 68H455.652ZM504.871 17.375H513.309V68H504.871V17.375ZM513.309 8.9375H504.871V0.5H513.309V8.9375ZM577.996 68V39.875C577.996 36.7402 577.762 34.1035 577.293 31.9648C576.824 29.7969 575.887 28.0537 574.48 26.7354C573.074 25.417 571.082 24.4648 568.504 23.8789C565.926 23.293 562.527 23 558.309 23C553.738 23 549.988 23.3369 547.059 24.0107C544.158 24.6846 541.873 25.6367 540.203 26.8672C538.533 28.0977 537.376 29.5771 536.731 31.3057C536.116 33.0342 535.809 34.9531 535.809 37.0625V68H527.371V17.375H535.809V25.8125C536.424 24.377 537.303 23.1465 538.445 22.1211C539.588 21.0664 540.877 20.1729 542.312 19.4404C543.748 18.708 545.301 18.1221 546.971 17.6826C548.641 17.2139 550.311 16.8623 551.98 16.6279C553.65 16.3643 555.262 16.1885 556.814 16.1006C558.396 16.0127 559.832 15.9688 561.121 15.9688C564.871 15.9688 568.094 16.2031 570.789 16.6719C573.514 17.1406 575.813 17.8291 577.688 18.7373C579.593 19.6455 581.116 20.7734 582.259 22.1211C583.401 23.4688 584.28 25.0361 584.896 26.8232C585.54 28.5811 585.965 30.5586 586.17 32.7559C586.375 34.9238 586.478 37.2969 586.478 39.875L586.434 68H577.996Z" fill="#FF0000"></path>
            </svg>
            <div class="d-flex justify-content-around my-2">
                <div class="spinner-grow text-primary" role="status" style="width: 1rem; height: 1rem;"></div>
                <div class="spinner-grow text-primary" role="status" style="width: 1rem; height: 1rem;"></div>
                <div class="spinner-grow text-primary" role="status" style="width: 1rem; height: 1rem;"></div>
                <div class="spinner-grow text-primary" role="status" style="width: 1rem; height: 1rem;"></div>
            </div>
        </div>
    </div>
    <script>
        const getCookie = (name) => {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }
        let action = ""
        let answerKeys = {
            "reboot": "ریبوت سرور", "power-on": "روشن کردن سرور",
            "power-off": "خاموش کردن سرور",
            "change-password": "تغییر رمز سرور", "delete": "حذف سرور",
            "change-ip": "تعویض آیپی v4"
        }

        async function api(action, slug) {
            let response = await fetch(`{{ api_url }}server-rent/cloud/action/${slug}/${action}/`, {
                method: "POST",
                credentials: 'include',
                headers: {"X-CSRFToken": getCookie("csrftoken")},
            });
            return await response.json()
        }

        function setLoading(key) {
            if (key == "on") {
                $("#loadingView").removeClass("d-none")
                $("#loadingView").addClass("d-flex")
            } else {
                $("#loadingView").removeClass("d-flex")
                $("#loadingView").addClass("d-none")
            }
        }

        function showToast(key, message=null) {
            if (key === "success") {
                $("#toast-message").text(message || "عملیات با موفقیت انجام شد")
                $("#toast-notification").removeClass("bg-danger");
                $("#toast-notification").addClass("bg-success");
            } else {
                $("#toast-message").text(message || "عملیات با خطا مواجه شد")
                $("#toast-notification").removeClass("bg-success");
                $("#toast-notification").addClass("bg-danger");
            }
            window.scrollTo({top: 0, behavior: 'smooth'});
            $("#toast-notification").toast("show");
        }

        function sendActionServer(action) {
            setLoading("on")
            let slug = window.location.href.split("/").slice(-2).join("")
            api(action, slug).then(response => {
                setLoading("off")
                let message = response["message"]
                if (response["status"] === true) {
                    if (response["password"]) {
                        $("#root-password").text(response["password"])
                        $("#wrapper-root-password").removeClass("d-none").addClass("d-flex")
                    } if (response["next"])
                        window.location.replace(response["next"])
                    if (response["ip"])
                        $("#ipv4").text(response["ip"])
                    showToast("success", message)
                } else {
                    showToast("error", message)
                }
            }).catch(() => {
                setLoading("off")
                showToast("error")
            })
        }

        $("#button-confirm").click(() => {
                $("#server-modal").modal("hide")
                sendActionServer(action)
        })

        function serverAction(act) {
            $("#content-modal").text(`عملیات ${answerKeys[act]} را تایید می کنید ؟`)
            $("#server-modal").modal("show")
            action = act
        }

    </script>
{% endblock %}